{{>user-profile}}

<div class="main-wrapper">

  <div class="posts">
    {{#each posts}}
    <div class="post_card">
    
      <a href="/user?id={{this.uid._id}}">
        <div class="user-info">
          <div class="userPic">
            <img src="{{this.uid.profileURL}}" />

          </div>
          <div class="user-name">
            <h4>


              {{this.uid.name}}


            </h4>
            <div class="post_date">

              <p>

                {{this.createdAt}}
              </p>
            </div>
          </div>

        </div>

 

      </a>

    

 <a href="/{{this._id}}">
      <div class="post_title">
        <h4>
          {{this.title}}
               {{#if (isDraftPost this.status) }}
<p class="draft-btn">Draft</p>
        {{/if}}
        </h4>
         </div>
        <div class="text-container">
          {{{this.html}}}
        </div>
     
 
 </a>
      <footer>

        <form action="/editPost?postId={{this._id}}" method="post">
          <button class="btn-2" type="submit"> Edit </button>
        </form>
        <button class="tiggerbtn btn">Delete</button>

        <div class="modal-wrapper">
          <div class="modal-contain">
            <h4> Do you want to delete this post?</h4>
            <div class="action-btn">

              <button class="cancelbtn btn-primary">Cancel</button>
              <form method="post" action="/post/delete/{{this._id}}">
                <button class="btn-secondary" type="submit">Delete</button>
              </form>
            </div>

          </div>
        </div>
      </footer>
    </div>
    {{/each}}
  </div>

</div>

<script defer>

  let modals = document.querySelectorAll(".modal-wrapper");
  let tiggerbtn = document.querySelectorAll(".tiggerbtn");
  let cancelbtns = document.querySelectorAll(".cancelbtn");




  // open modal
  tiggerbtn.forEach((btn, i) => {
    tiggerbtn[i].addEventListener("click", () => {
      modals[i].classList.toggle("show-modal");

    })

  })

  //cancle modal when cancle btn is clicked
  cancelbtns.forEach((btn, i) => {
    cancelbtns[i].addEventListener("click", () => {
      modals[i].classList.toggle("show-modal");
    })
  })




  // cancel modal when user clicked outside the box
  window.addEventListener("click", (e) => {

    for (const modal of modals) {

      if (e.target === modal) {
        modal.classList.toggle("show-modal");
      }
    }


  })


</script>